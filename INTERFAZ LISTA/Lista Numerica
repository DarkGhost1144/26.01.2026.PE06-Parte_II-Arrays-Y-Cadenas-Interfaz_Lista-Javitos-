/**
 * Implementación de la interfaz mediante un array de enteros. La lista tiene un
 * tamaño máximo fijo y permite operaciones básicas como inserción, eliminación,
 * búsqueda y unión de listas.
 *
 * @author Jkur
 * @version 1.0
 * @see String
 * @see Lista
 */
public class ListaNumerica implements Lista {

    /**
     * Array que almacena los elementos de la lista
     */
    private int[] lista;

    /**
     * Tamaño máximo permitido para la lista
     */
    private final int TAM_MAX = 100;

    /**
     * Número actual de elementos en la lista
     */
    private int tamanyo;

    /**
     * Constructor por defecto. Inicializa la lista vacía con tamaño máximo
     * predefinido.
     */
    public ListaNumerica() {
        this.lista = new int[TAM_MAX];
        this.tamanyo = 0;
    }

    /**
     * Devuelve el tamaño actual de la lista.
     *
     * @return número de elementos almacenados
     */
    @Override
    public int getTamanyo() {
        return this.tamanyo;
    }

    /**
     * Inserta un valor al final de la lista si hay espacio disponible.
     *
     * @param valor número entero a insertar
     */
    @Override
    public void insertarAlFinal(int valor) {
        if (tamanyo < TAM_MAX) {
            lista[tamanyo] = valor;
            tamanyo++;
        } else {
            System.out.println("Error: La lista está llena.");
        }
    }

    /**
     * Inserta un valor al principio de la lista.
     *
     * @param valor número entero a insertar
     */
    @Override
    public void insertarAlPrincipio(int valor) {
        insertarEnLaPosicion(0, valor);
    }

    /**
     * Inserta un valor en una posición específica de la lista. Desplaza los
     * elementos hacia la derecha.
     *
     * @param posicion índice donde se insertará el valor
     * @param valor número entero a insertar
     */
    @Override
    public void insertarEnLaPosicion(int posicion, int valor) {
        if (tamanyo >= TAM_MAX) {
            System.out.println("Error: Lista llena.");
            return;
        }
        if (posicion < 0 || posicion > tamanyo) {
            System.out.println("Error: Posición inválida.");
            return;
        }

        for (int i = tamanyo; i > posicion; i--) {
            lista[i] = lista[i - 1];
        }

        lista[posicion] = valor;
        tamanyo++;
    }

    /**
     * Elimina el primer elemento de la lista.
     */
    @Override
    public void eliminarLaPrimera() {
        eliminar(0);
    }

    /**
     * Elimina el último elemento de la lista.
     */
    @Override
    public void eliminarLaUltima() {
        if (tamanyo > 0) {
            tamanyo--;
        }
    }

    /**
     * Elimina un elemento de la lista en una posición concreta. Desplaza los
     * elementos hacia la izquierda.
     *
     * @param posicion índice del elemento a eliminar
     */
    @Override
    public void eliminar(int posicion) {
        if (posicion < 0 || posicion >= tamanyo) {
            System.out.println("Error: Posición inválida.");
            return;
        }

        for (int i = posicion; i < tamanyo - 1; i++) {
            lista[i] = lista[i + 1];
        }

        tamanyo--;
    }

    /**
     * Busca un número dentro de la lista.
     *
     * @param n número a buscar
     * @return posición del número si se encuentra, o -1 si no existe
     */
    @Override
    public int buscar(int n) {
        for (int i = 0; i < tamanyo; i++) {
            if (lista[i] == n) {
                return i;
            }
        }
        return -1;
    }

    /**
     * Une la lista actual con otra lista numérica.
     *
     * @param lista2 lista que se desea unir
     */
    @Override
    public void unirDosListas(Lista lista2) {
        if (lista2 instanceof ListaNumerica) {
            ListaNumerica otraLista = (ListaNumerica) lista2;

            if (this.tamanyo + otraLista.getTamanyo() > TAM_MAX) {
                System.out.println("Error: No caben todos los elementos.");
                return;
            }

            for (int i = 0; i < otraLista.getTamanyo(); i++) {
                this.insertarAlFinal(otraLista.lista[i]);
            }
        }
    }

    /**
     * Devuelve una representación en forma de cadena de la lista.
     *
     * @return cadena con los elementos de la lista
     */
    @Override
    public String imprimirLista() {
        String resultado = "[ ";

        for (int i = 0; i < tamanyo; i++) {
            resultado += lista[i];
            if (i < tamanyo - 1) {
                resultado += ", ";
            }
        }

        resultado += " ]";
        return resultado;
    }

    /**
     * Devuelve la representación en forma de cadena de la lista.
     *
     * @return cadena con los elementos de la lista
     */
    @Override
    public String toString() {
        return imprimirLista();
    }
}
